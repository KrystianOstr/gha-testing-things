name: env-n-secrets v2

on:
  push:
  workflow_dispatch:

jobs:
  producer:
    runs-on: ubuntu-latest
    outputs:
      janusz_sprawdzam_czy_rozumiem_zmienne: ${{ steps.expose.outputs.janusz_sprawdzam_czy_rozumiem_zmienne }}
      meta: ${{ steps.expose.outputs.meta }}
    steps:
      - name: read secret and expose it
        id: expose
        env:
          MY_SECRET: ${{ secrets.MY_SECRET }}
        run: |
          echo "janusz_sprawdzam_czy_rozumiem_zmienne=$MY_SECRET" >> "$GITHUB_OUTPUT"
          echo "meta=env-ready" >> "$GITHUB_OUTPUT"

  consumer:
    needs: producer
    runs-on: ubuntu-latest
    steps:
      - name: use job output
        run: |
          echo "Cross-job: ${{ needs.producer.outputs.janusz_sprawdzam_czy_rozumiem_zmienne }}"
          echo "Meta: ${{ needs.producer.outputs.meta }}"
